machine:
  xcode:
    version: "8.3"

checkout:
  post:
    - ./install.sh

dependencies:
  override:
    - gem install xcpretty
    - gem install fastlane
    - gem install danger
    - gem install danger-xcov
    - gem install danger-junit
    - gem install coveralls
    - brew update
    - brew install ant
    - brew install npm
    - npm install shelljs@0.7.0

test:
  override:
    - echo scheme="UnitTests"
    - ./build/pre-build
    - fastlane PR
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/slather
    - cp slather_output/cobertura.xml $CIRCLE_TEST_REPORTS/slather
    - mkdir -p $CIRCLE_TEST_REPORTS/junit
    - cp test_output/*.junit $CIRCLE_TEST_REPORTS/junit

general:
  artifacts:
    - *_output/**
    - fastlane/report.xml
