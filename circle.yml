machine:
  xcode:
    version: "8.3"

checkout:
  post:
    - ./install.sh

dependencies:
  override:
    - gem install xcpretty
    - gem install fastlane
    - brew update
    - brew install ant
    - brew install npm
    - npm install shelljs@0.7.0

test:
  override:
    - echo scheme="UnitTests"
    - ./build/pre-build
    - fastlane PR
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/slather_output
    - cp slather_output/cobertura.xml $CIRCLE_TEST_REPORTS/slather_output/
    - mkdir -p $CIRCLE_TEST_REPORTS/test_output
    - cp test_output/report.html $CIRCLE_TEST_REPORTS/test_output/
    - cp test_output/report.junit $CIRCLE_TEST_REPORTS/test_output/
